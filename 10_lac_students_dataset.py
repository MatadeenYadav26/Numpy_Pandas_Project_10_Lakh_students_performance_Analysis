# -*- coding: utf-8 -*-
"""10_lac_students_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NEJwBk08jxOKAy22ScVcUhSNmXveeWzE

### How many rows and columns are there in the dataset?
"""

import numpy as np
import pandas as pd

df = pd.read_csv("student_performance.csv")
df

#Number of rows and columns present:
df.shape

"""### Show the first 10 rows of the dataset."""

df.head(10)

"""### Show the last 10 rows of the dataset."""

df.tail(10)

"""### What are the column names in the dataset?"""

df.columns

"""### What is the maximum value of weekly_self_study_hours?"""

# df.max('weekly_self_study_hours') - common mistake done by me.
df['weekly_self_study_hours'].max()



"""### Which student studied the most hours in a week?"""

# details of students with max weekly study hours

df[df['weekly_self_study_hours']  == df['weekly_self_study_hours'].max()]

"""### Show the top 5 students by weekly_self_study_hours."""

df.sort_values('weekly_self_study_hours',ascending=False).head(5)

"""### Which student has the highest attendance percentage?"""

df[df['attendance_percentage'] == df['attendance_percentage'].max()]

std = df[df['attendance_percentage'] == df['attendance_percentage'].max()].count()['student_id']
std

#for percentage =>
std = df[df['attendance_percentage'] == df['attendance_percentage'].max()].count()['student_id']
total = df.shape[0]
per = std/total*100
per

"""### Which student has the highest class participation?"""

df[df['class_participation'] == df['class_participation'].max()]

#percent :
cpstd = df[df['class_participation'] == df['class_participation'].max()].count()['student_id']
cpstd

cpstd/total*100

"""### Create a new column score_level
"High" if total_score ≥ 90 , "Medium" if 70 ≤ total_score < 90, "Low" if total_score < 70
"""

def level(x):
  if x >= 90:
    return "High";
  elif x>= 70 :
    return "Medium";
  else:
    return "Low";

df['Scoring_Level'] = df.total_score.apply(level)

df

"""### Which student has the highest total_score?"""

hgh = df[df['total_score'] == df['total_score'].max()]
hgh

# percentage of student with max score :
ts = df[df['total_score'] == df['total_score'].max()].count()['student_id']
ts

#percentage of students with max score:
ts/total*100

"""### How many students scored exactly 100 in total_score?"""

len(df[df['total_score'] == df['total_score'].max()])

"""### Make a new column for study efficiency = total_score ÷ weekly_self_study_hours."""

#we cab solve this by either creating functions or using lambda functions : but we use broadcasting:-
df['study_efficiency'] = df['total_score']/df['weekly_self_study_hours'] # panda automatically itna smart h ki vo khud ek new table create kardega , no need to go long by functions.
df

"""### Create a new column study_category
"Light" if weekly_self_study_hours < 10,
"Moderate" if 10 ≤ hours ≤ 20,
"Heavy" if hours > 20
"""

def category(x):
  if x <10:
    return "Light";
  elif x<=20:
    return "Moderate";
  else:
    return "Heavy";

df['Study_Category'] = df['weekly_self_study_hours'].apply(category)
df